---
import Layout from "src/layouts/MainLayout.astro";
import events from "../events.json";
import linkify from "linkify-string";

const addressToLink = (address: string) =>
  "https://www.google.com/maps/search/" +
  new URLSearchParams({ api: "1", query: encodeURIComponent(address) });
---

<Layout title="Events | Jeremiah Lockwood" active="events">
  <h1>Events</h1>
  <main>
    {
      events.length ? (
        events.map(({ title, date, address, description, long }) => (
          <div class:list={["event", { long }]}>
            <p>{date}</p>
            <p>{title}</p>
            {address && (
              <p>
                <a href={addressToLink(address)}>{address}</a>
              </p>
            )}
            {description.map((paragraph) => (
              <p set:html={linkify(paragraph)} />
            ))}
          </div>
        ))
      ) : (
        <p>No upcoming events right now.</p>
      )
    }
  </main>
</Layout>

<style>
  main {
    display: flex;
    flex-wrap: wrap;
  }
  h1 {
    text-align: center;
  }
  h2 {
    display: block;
  }
  .event {
    width: 35ch;
    padding: 2em;
    margin: 2em;
    line-height: 1.4;
    font-size: 1.2rem;
    word-wrap: break-word;
  }
  .event.long {
    width: 70ch;
  }
  .event a {
    display: block;
  }
  .event p {
    padding: 0;
    margin: 0.8rem 0;
  }
</style>
